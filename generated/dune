(subdir dune.inc
 (rule
  (target dockerfiles-list.inc)
  (mode (promote (until-clean)))
  (action
   (run
     ../../generators/gen_dockerfiles.exe
     -info %{dep:../../info/available-docker-image.json}
     -output %{target} -outdir "dockerfiles"))))

(rule
 (targets
  (dir dockerfiles))
 (alias all)
 (mode (promote (until-clean)))
 (action
  (progn
   (system "mkdir -p dockerfiles")
   (run
     ../generators/gen_dockerfiles.exe
     -info %{dep:../info/available-docker-image.json}
     -target "(all-dockerfiles)" -resdir "../../.." -outdir dockerfiles))))
